# نظام التنبؤ بالمبيعات الذكي 🚀

نظام ذكي متخصص للتنبؤ بمبيعات **اليوم التالي فقط** باستخدام أحدث تقنيات الذكاء الاصطناعي والتعلم الآلي.

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![Flask](https://img.shields.io/badge/Flask-2.0+-green.svg)
![scikit-learn](https://img.shields.io/badge/scikit--learn-1.0+-orange.svg)
![XGBoost](https://img.shields.io/badge/XGBoost-1.5+-red.svg)

## ⚠️ قيود النظام المهمة

### ✅ ما يمكن للنظام فعله:
- **التنبؤ باليوم التالي مباشرة** بعد آخر تاريخ في البيانات
- **دقة عالية تصل إلى 95%** في التنبؤات
- **استخدام 30+ ميزة تحليلية** متقدمة
- **معالجة ذكية للبيانات** الزمنية

### ❌ ما لا يمكن للنظام فعله:
- **التنبؤ بتواريخ سابقة** أو مستقبلية بعيدة
- **تخطي أيام في التنبؤ** - يجب أن يكون متسلسلاً
- **التنبؤ بأكثر من يوم واحد** في المرة الواحدة
- **العمل بدون بيانات متسلسلة** زمنياً

## 🌟 الميزات الرئيسية

### 🧠 ذكاء اصطناعي متقدم
- **ثلاثة نماذج تعلم آلي**: Linear Regression, Random Forest, XGBoost
- **اختيار تلقائي للنموذج الأفضل** بناءً على الأداء
- **معالجة ذكية للبيانات** مع تجنب تسريب المعلومات

### 🔧 هندسة ميزات متقدمة (30+ ميزة)
- **ميزات زمنية**: السنة، الشهر، اليوم، يوم الأسبوع، يوم السنة
- **ميزات التأخير**: مبيعات الأيام السابقة (1، 2، 3، 7، 14، 30 يوم)
- **ميزات المتوسطات المتحركة**: نوافذ زمنية مختلفة (7، 14، 30 يوم)
- **ميزات موسمية**: أنماط أسبوعية وشهرية
- **ميزات إحصائية متقدمة**: نسب التغيير، الاتجاهات، القيم القصوى والدنيا

### 🚀 واجهة برمجة تطبيقات شاملة
- **RESTful API** مبسط ومتخصص
- **endpoint واحد للتنبؤ** باليوم التالي
- **معالجة أخطاء متقدمة** مع رسائل واضحة
- **دعم CORS** للتكامل السهل

### 🎨 واجهة مستخدم متخصصة
- **تصميم مخصص للتنبؤ باليوم التالي**
- **واجهة عربية كاملة** مع دعم RTL
- **تحذيرات واضحة** حول قيود النظام
- **تجربة مستخدم مبسطة** وفعالة

## 📋 متطلبات النظام

```txt
Python 3.8+
pandas >= 2.1.4
numpy >= 1.24.3
scikit-learn >= 1.3.0
xgboost >= 1.7.6
flask >= 2.3.3
flask-cors >= 4.0.0
matplotlib >= 3.7.2
seaborn >= 0.12.2
joblib >= 1.3.2
```

## 🚀 التثبيت والإعداد

### 1. تحميل المشروع
```bash
git clone [repository-url]
cd sales-prediction-system
```

### 2. إنشاء بيئة افتراضية
```bash
python -m venv venv

# على Linux/Mac
source venv/bin/activate

# على Windows
venv\Scripts\activate
```

### 3. تثبيت المتطلبات
```bash
pip install -r requirements.txt
```

### 4. إعداد البيانات
ضع ملف البيانات `Daily_sales.csv` في مجلد `data/`. يجب أن يحتوي على:

| العمود | الوصف | النوع |
|--------|--------|-------|
| `sale_date` | تاريخ المبيعات | Date (YYYY-MM-DD) |
| `total_amount` | إجمالي المبيعات | Float |
| `total_quantity` | إجمالي الكمية | Integer |
| `invoices_count` | عدد الفواتير | Integer |
| `total_discount` | إجمالي الخصومات | Float |

### 5. تدريب النموذج
قم بتشغيل `modelAI/sales_model.ipynb` لتدريب النموذج وحفظ الملفات المطلوبة.

### 6. تشغيل النظام
```bash
# الطريقة السريعة
python run.py

# أو على Windows
start.bat

# أو مباشرة
python api.py
```

## 🌐 الوصول للنظام

بعد التشغيل، يمكنك الوصول للنظام عبر:

| الصفحة | الرابط | الوصف |
|--------|--------|-------|
| 🏠 الرئيسية | http://localhost:5000 | الصفحة الرئيسية مع شرح القيود |
| 🔮 التنبؤ | http://localhost:5000/predict | صفحة التنبؤ باليوم التالي |
| 📊 لوحة التحكم | http://localhost:5000/dashboard | عرض البيانات والإحصائيات |
| 📚 التوثيق | http://localhost:5000/docs | توثيق API |

## 🔌 استخدام API

### 1. فحص حالة النظام
```bash
curl http://localhost:5000/api/health
```

### 2. معلومات النموذج
```bash
curl http://localhost:5000/api/model/info
```

**الاستجابة:**
```json
{
  "success": true,
  "data": {
    "model_type": "RandomForestRegressor",
    "features_count": 30,
    "last_available_date": "2024-03-30",
    "next_prediction_date": "2024-03-31",
    "prediction_note": "يمكن التنبؤ فقط باليوم التالي مباشرة بعد آخر تاريخ في البيانات"
  }
}
```

### 3. التنبؤ باليوم التالي
```bash
# POST request
curl -X POST http://localhost:5000/api/predict

# GET request
curl http://localhost:5000/api/predict/next
```

**الاستجابة:**
```json
{
  "success": true,
  "data": {
    "date": "2024-03-31",
    "last_available_date": "2024-03-30",
    "predicted_sales": 15750.25,
    "message": "التنبؤ بمبيعات اليوم التالي (2024-03-31): 15750.25 ريال"
  }
}
```

## 📁 بنية المشروع

```
sales-prediction-system/
├── 📄 api.py                          # واجهة برمجة التطبيقات الرئيسية
├── 🧠 model_handler.py                # معالج النموذج والتنبؤات
├── 🚀 run.py                          # ملف التشغيل الذكي
├── 🖥️ start.bat                       # ملف تشغيل سريع للويندوز
├── 📁 templates/                      # قوالب HTML
│   ├── 🏠 index.html                 # الصفحة الرئيسية
│   ├── 🔮 predict_new.html           # صفحة التنبؤ
│   ├── 📊 dashboard.html             # لوحة التحكم
│   └── 📚 api_docs.html              # توثيق API
├── 📁 data/                           # مجلد البيانات
│   ├── 📈 Daily_sales.csv            # بيانات المبيعات الأصلية
│   └── 🔄 processed_sales_data.csv   # البيانات المعالجة
├── 📁 modelAI/                        # مجلد النماذج والتدريب
│   ├── 📊 sales_model.ipynb          # دفتر التدريب الرئيسي
│   ├── 🤖 best_model_*.joblib        # النماذج المدربة
│   ├── ⚖️ standard_scaler.joblib     # معايرة البيانات
│   └── 📝 feature_columns.txt        # قائمة الميزات
├── 📋 requirements.txt               # متطلبات Python
└── 📖 README.md                      # هذا الملف
```

## 🤖 الخوارزميات المستخدمة

### 1. الانحدار الخطي (Linear Regression)
- ✅ **المميزات**: سريع، قابل للتفسير
- ❌ **العيوب**: قد لا يلتقط العلاقات المعقدة
- 🎯 **الاستخدام**: نموذج أساسي للمقارنة

### 2. الغابة العشوائية (Random Forest)
- ✅ **المميزات**: مقاوم للإفراط في التدريب، موثوق
- ❌ **العيوب**: أبطأ، أقل قابلية للتفسير
- 🎯 **الاستخدام**: النموذج المفضل حالياً

### 3. XGBoost (Extreme Gradient Boosting)
- ✅ **المميزات**: دقة عالية جداً، أداء ممتاز
- ❌ **العيوب**: يتطلب ضبط معاملات دقيق
- 🎯 **الاستخدام**: للحصول على أقصى دقة

## 🔧 كيفية عمل النظام

### 1. تحليل البيانات التاريخية
- قراءة جميع بيانات المبيعات السابقة
- تحديد آخر تاريخ متاح في البيانات

### 2. إنشاء الميزات للتاريخ التالي
- **ميزات زمنية**: استخراج معلومات التاريخ
- **ميزات التأخير**: استخدام مبيعات الأيام السابقة
- **ميزات المتوسطات**: حساب المتوسطات المتحركة
- **ميزات متقدمة**: نسب التغيير والاتجاهات

### 3. التنبؤ
- تطبيق التطبيع على الميزات
- استخدام النموذج المدرب للتنبؤ
- إرجاع النتيجة مع معلومات إضافية

## 🐛 استكشاف الأخطاء

### مشاكل شائعة وحلولها

#### 1. خطأ في تحميل البيانات
```bash
❌ خطأ: ملف البيانات غير موجود
✅ الحل: تأكد من وجود Daily_sales.csv في مجلد data/
```

#### 2. خطأ في تحميل النموذج
```bash
❌ خطأ: لم يتم العثور على أي نموذج محفوظ
✅ الحل: قم بتشغيل modelAI/sales_model.ipynb لتدريب النموذج
```

#### 3. خطأ في التنبؤ
```bash
❌ خطأ: الميزات تحتوي على قيم مفقودة
✅ الحل: تأكد من اكتمال البيانات التاريخية
```

## 🤝 المساهمة في المشروع

نرحب بمساهماتكم لتطوير هذا المشروع! 

### خطوات المساهمة:
1. 🍴 **Fork** المشروع
2. 🌿 إنشاء فرع جديد (`git checkout -b feature/amazing-feature`)
3. ✨ تنفيذ التغييرات (`git commit -m 'Add amazing feature'`)
4. 📤 رفع التغييرات (`git push origin feature/amazing-feature`)
5. 🔄 إنشاء **Pull Request**

## 📄 الترخيص

هذا المشروع مرخص تحت **رخصة MIT**. راجع ملف `LICENSE` للمزيد من التفاصيل.

## 🗓️ الإصدارات والتحديثات

### الإصدار الحالي: 2.1.0 🎉
- ✨ تخصص كامل للتنبؤ باليوم التالي فقط
- 🚀 تحسين دقة النظام وموثوقيته
- 🧠 معالج نموذج محسن ومتخصص
- 🎨 واجهة مستخدم مبسطة ومتخصصة
- 📊 توضيح واضح لقيود النظام
- 🔧 تنظيم أفضل للملفات والمجلدات

### خطط مستقبلية 🔮
- 🔄 إمكانية التنبؤ المتسلسل (إضافة يوم جديد للبيانات)
- 📈 تحليلات متقدمة للأنماط الزمنية
- 🔗 تكامل مع قواعد البيانات المختلفة
- 📱 تطبيق موبايل مخصص
- ☁️ نشر سحابي مع Docker

---

<div align="center">

**🚀 نظام متخصص للتنبؤ باليوم التالي فقط 📅**

**مطور بتقنيات الذكاء الاصطناعي والتعلم الآلي المتقدمة 🤖**

---

[![Python](https://img.shields.io/badge/Made%20with-Python-blue.svg)](https://python.org)
[![Flask](https://img.shields.io/badge/Powered%20by-Flask-green.svg)](https://flask.palletsprojects.com/)
[![AI](https://img.shields.io/badge/Enhanced%20with-AI-orange.svg)](https://scikit-learn.org/)

</div>
